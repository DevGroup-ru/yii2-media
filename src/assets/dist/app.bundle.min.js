!function(e){function t(s){if(a[s])return a[s].exports;var n=a[s]={i:s,l:!1,exports:{}};return e[s].call(n.exports,n,n.exports,t),n.l=!0,n.exports}var a={};t.m=e,t.c=a,t.i=function(e){return e},t.d=function(e,a,s){t.o(e,a)||Object.defineProperty(e,a,{configurable:!1,enumerable:!0,get:s})},t.n=function(e){var a=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(a,"a",a),a},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="/",t(t.s=2)}([function(e,t,a){"use strict";function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var a=0;a<t.length;a++){var s=t[a];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}return function(t,a,s){return a&&e(t.prototype,a),s&&e(t,s),t}}(),i=function(){function e(t){var a=this;s(this,e),this.$input=t,this.$object=t.closest(".media-attachment"),this.settings={dragOverClass:"media-attachment__selected-files_drag_over",isUploadingClass:"media-attachment__selected-files_is_uploading",isSuccessClass:"media-attachment__selected-files_is_success",isErrorClass:"media-attachment__selected-files_is_error"},this.uploadTarget=this.$input.data("uploadTarget"),this.modelClassNameHash=this.$input.data("modelClassnameHash"),this.modelId=this.$input.data("modelId"),this.relationName=this.$input.data("relationName"),this.csrfParam=this.$input.data("csrfParam"),this.csrfToken=this.$input.data("csrfToken"),this.$galleryContainer=this.$object.find(".media-attachment__gallery-container"),this.$browseGallery=this.$object.find(".media-attachment__browse"),this.$browseGallery.click(function(){a.$galleryContainer.toggleClass("media-attachment__gallery-container_active")}),this.$uploadButton=this.$object.find(".media-attachment__upload"),this.$fakeInput=$('<input type="file" multiple>').attr("name","UploadModel[files][]"),this.$uploadButton.click(function(){return a.$fakeInput.click(),!1}),this.$selectedFiles=this.$object.find(".media-attachment__selected-files"),this.droppedFiles=!1,this.bindUpload()}return n(e,[{key:"bindUpload",value:function(){var e=this;this.$selectedFiles.on("drag dragstart dragend dragover dragenter dragleave drop",function(e){e.preventDefault(),e.stopPropagation()}).on("dragover dragenter",function(){e.$selectedFiles.addClass(e.settings.dragOverClass)}).on("dragleave dragend drop",function(){e.$selectedFiles.removeClass(e.settings.dragOverClass)}).on("drop",function(t){e.droppedFiles=t.originalEvent.dataTransfer.files,e.submit()}),this.$fakeInput.change(function(){e.droppedFiles=e.$fakeInput[0].files,e.submit()})}},{key:"submit",value:function(){var e=this;this.$selectedFiles.addClass(this.settings.isUploadingClass);var t=new window.FormData;$.each(this.droppedFiles,function(e,a){t.append("UploadModel[files][]",a)}),t.append(this.csrfParam,this.csrfToken),t.append("UploadModel[model_class_name_hash]",this.modelClassNameHash),t.append("UploadModel[model_id]",this.modelId),t.append("UploadModel[relation_name]",this.relationName),$.ajax({url:this.uploadTarget,method:"POST",data:t,dataType:"json",cache:!1,contentType:!1,processData:!1,complete:function(){e.$selectedFiles.removeClass(e.settings.isUploadingClass),e.droppedFiles=!1},success:function(t){e.$selectedFiles.addClass(t.success===!0?e.settings.isSuccessClass:e.settings.isErrorClass),t.success}})}}],[{key:"bindToInput",value:function(t){return new e(t instanceof $?t:$("#"+t))}}]),e}();t.default=i},function(e,t){},function(e,t,a){"use strict";function s(e){return e&&e.__esModule?e:{default:e}}a(1);var n=a(0),i=s(n);window.MediaAttachment=i.default}]);