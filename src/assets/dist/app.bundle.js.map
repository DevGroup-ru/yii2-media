{"version":3,"sources":["webpack:///webpack/bootstrap 9e93f629b9a2412bf757","webpack:///./src/Attachment.js","webpack:///./src/app.scss","webpack:///./src/index.js"],"names":["Attachment","$input","$object","closest","settings","dragOverClass","isUploadingClass","isSuccessClass","isErrorClass","uploadTarget","data","modelClassNameHash","modelId","relationName","csrfParam","csrfToken","$galleryContainer","find","$browseGallery","click","toggleClass","$uploadButton","$fakeInput","$","attr","$selectedFiles","droppedFiles","bindUpload","on","e","preventDefault","stopPropagation","addClass","removeClass","originalEvent","dataTransfer","files","submit","change","formData","window","FormData","each","i","file","append","ajax","url","method","dataType","cache","contentType","processData","complete","success","input","MediaAttachment"],"mappings":"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","file":"app.bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 2);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 9e93f629b9a2412bf757","class Attachment {\n  constructor($input) {\n    this.$input = $input;\n    this.$object = $input.closest('.media-attachment');\n\n    this.settings = {\n      dragOverClass: 'media-attachment__selected-files_drag_over',\n      isUploadingClass: 'media-attachment__selected-files_is_uploading',\n      isSuccessClass: 'media-attachment__selected-files_is_success',\n      isErrorClass: 'media-attachment__selected-files_is_error'\n    };\n\n    this.uploadTarget = this.$input.data('uploadTarget');\n    this.modelClassNameHash = this.$input.data('modelClassnameHash');\n    this.modelId = this.$input.data('modelId');\n    this.relationName = this.$input.data('relationName');\n\n    this.csrfParam = this.$input.data('csrfParam');\n    this.csrfToken = this.$input.data('csrfToken');\n\n    this.$galleryContainer = this.$object.find('.media-attachment__gallery-container');\n\n    this.$browseGallery = this.$object.find('.media-attachment__browse');\n    this.$browseGallery.click(() => {\n      this.$galleryContainer.toggleClass('media-attachment__gallery-container_active');\n    });\n\n    this.$uploadButton = this.$object.find('.media-attachment__upload');\n\n    this.$fakeInput = $('<input type=\"file\" multiple>')\n      .attr('name', 'UploadModel[files][]');\n\n    this.$uploadButton.click(() => {\n      this.$fakeInput.click();\n      return false;\n    });\n\n\n    this.$selectedFiles = this.$object.find('.media-attachment__selected-files');\n\n    this.droppedFiles = false;\n\n    this.bindUpload();\n  }\n\n  bindUpload() {\n    this.$selectedFiles\n      .on('drag dragstart dragend dragover dragenter dragleave drop', function (e) {\n        // preventing the unwanted behaviours\n        e.preventDefault();\n        e.stopPropagation();\n      })\n      .on('dragover dragenter', () => {\n        this.$selectedFiles.addClass(this.settings.dragOverClass);\n      })\n      .on('dragleave dragend drop', () => {\n        this.$selectedFiles.removeClass(this.settings.dragOverClass);\n      })\n      .on('drop', (e) => {\n        this.droppedFiles = e.originalEvent.dataTransfer.files; // the files that were dropped\n        // trigger submit\n        this.submit();\n      });\n    this.$fakeInput.change(() => {\n      this.droppedFiles = this.$fakeInput[0].files;\n      this.submit();\n    });\n  }\n\n  submit() {\n    this.$selectedFiles.addClass(this.settings.isUploadingClass);\n    const formData = new window.FormData();\n    $.each(this.droppedFiles, function(i, file) {\n      formData.append('UploadModel[files][]', file);\n    });\n    formData.append(this.csrfParam, this.csrfToken);\n    formData.append('UploadModel[model_class_name_hash]', this.modelClassNameHash);\n    formData.append('UploadModel[model_id]', this.modelId);\n    formData.append('UploadModel[relation_name]', this.relationName);\n\n    $.ajax({\n      url: this.uploadTarget,\n      method: 'POST',\n      data: formData,\n      dataType: 'json',\n      cache: false,\n      contentType: false,\n      processData: false,\n      complete: () => {\n        this.$selectedFiles.removeClass(this.settings.isUploadingClass);\n        this.droppedFiles = false;\n      },\n      success: (data) => {\n        this.$selectedFiles\n          .addClass(data.success === true ? this.settings.isSuccessClass : this.settings.isErrorClass);\n        if (!data.success) {\n          // $errorMsg.text(data.error);\n        }\n      }\n    });\n  }\n\n  static bindToInput(input) {\n    const $input = input instanceof $ ? input : $(`#${input}`);\n\n    return new Attachment($input);\n  }\n}\n\nexport default Attachment;\n\n\n// WEBPACK FOOTER //\n// ./src/Attachment.js","// removed by extract-text-webpack-plugin\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/app.scss\n// module id = 1\n// module chunks = 0","import './app.scss';\n\nimport Attachment from './Attachment';\n\nwindow.MediaAttachment = Attachment;\n\n\n// WEBPACK FOOTER //\n// ./src/index.js"],"sourceRoot":""}